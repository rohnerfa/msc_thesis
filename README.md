# Numerical Experiment MSc Thesis

This repository contains the implementation to reproduce the numerical experiments in my Master thesis.

## Installation
Required packages:
```bash
pip install numpy
pip install matplotlib
pip install pytorch
pip install pytorch-lightning
pip install pandas
pip install tqdm
pip install tensorflow
```
Note that TensorFlow is only required to parse the TensorBoard logs.

## Training: ensemble and retraining

In the main directory run

  python train.py 'training_type'
  
**training_type**:
- *ensemble*, to perform ensemble training, modify the possible values in the model_hyperparams dictionary if necessary
- *retrain*, to perform retraining, modify 'n_retrain' if necessary, requires the files 'best_config_1.json', 'best_config_2.json', 'best_config_3.json' generated by ensemble training, alternatively create the files manually containing a dictionary with the desired hyperparameters 
- *both*, performs both ensemble training and then retraining

The results of both ensemble and retraining can be found in the '/logs' folder, which contains a training history for each model as TensorBoard log, a model checkpoint for the last epoch, the best model hyperparameters found during ensemble training and a file containing training time and test losses for each model.

## Results
An overview of the training results accompanied by plots of the learned functions can be found in the notebook 'Comparison_thesis.ipynb'.
